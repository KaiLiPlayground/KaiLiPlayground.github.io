<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Kai Li">
    
    <title>
        
        Kai Li
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/hello_new.jpg">
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"kailiplayground.github.io","root":"/","language":"en","path":"search.xml"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"/images/hello_new.jpg","favicon":"/images/hello_new.jpg","avatar":"/images/hello_new.jpg","font_size":null,"font_family":null,"hover":{"shadow":false,"scale":false},"first_screen":{"enable":false,"header_transparent":false,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","font_color":null,"hitokoto":false},"scroll":{"progress_bar":false,"percent":false}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":false},"lazyload":{"enable":false},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"enable":false,"wordcount":false,"min2read":false},"img_align":"left","copyright_info":false},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original article title","author":"Original article author","link":"Original article link"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/hello_new.jpg">
                </a>
            
            <a class="logo-title" href="/">
               Kai Li
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation"></span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/hello_new.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Kai Li</span>
                            
                                <span class="author-label">Lv2</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2024-01-05 17:45:36</span>
        <span class="mobile">2024-01-05 17:45</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2024-01-05 17:45:36</span>
    </span>
    
    
    

    
    
    
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <p>To reference outputs from another stack in your current CloudFormation template, you use the <code>Fn::ImportValue</code> function. This function allows you to import values that were exported by other stacks. For this to work, the exporting stack must explicitly declare its outputs as exports, and the importing stack can then use these exported values.</p>
<h3 id="How-it-Works"><a href="#How-it-Works" class="headerlink" title="How it Works:"></a>How it Works:</h3><h4 id="1-Exporting-Outputs-in-One-Stack"><a href="#1-Exporting-Outputs-in-One-Stack" class="headerlink" title="1. Exporting Outputs in One Stack:"></a>1. Exporting Outputs in One Stack:</h4><p>In the stack that creates the resource (e.g., Lambda function), you’ll need to add an <code>Exports</code> section in the Outputs. For example:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Outputs:</span></span><br><span class="line">  <span class="attr">DataEngCheckFileExtFunctionArn:</span></span><br><span class="line">    <span class="attr">Value:</span> <span class="type">!GetAtt</span> <span class="string">DataEngCheckFileExtFunction.Arn</span></span><br><span class="line">    <span class="attr">Export:</span></span><br><span class="line">      <span class="attr">Name:</span> <span class="string">DataEngCheckFileExtFunctionArn</span></span><br></pre></td></tr></table></figure>

<p>This snippet exports the ARN of a Lambda function.</p>
<h4 id="2-Importing-Outputs-in-Another-Stack"><a href="#2-Importing-Outputs-in-Another-Stack" class="headerlink" title="2. Importing Outputs in Another Stack:"></a>2. Importing Outputs in Another Stack:</h4><p>In a separate stack (e.g., the one with the Step Function), you use <code>Fn::ImportValue</code> to import the exported value:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Resource:</span> <span class="type">!ImportValue</span> <span class="string">DataEngCheckFileExtFunctionArn</span></span><br></pre></td></tr></table></figure>

<p>This snippet imports the ARN of the Lambda function into the Step Function stack.</p>
<h3 id="Deployment-Process-Without-CodePipeline"><a href="#Deployment-Process-Without-CodePipeline" class="headerlink" title="Deployment Process Without CodePipeline:"></a>Deployment Process Without CodePipeline:</h3><ol>
<li><strong>Deploy Dependent Stacks First</strong>: You need to deploy the stacks that contain the resources being exported first (e.g., Lambda functions, SNS topics).</li>
<li><strong>Deploy Consuming Stacks Later</strong>: Once the dependent stacks are successfully deployed and their outputs are exported, you can then deploy the stacks that import those values (e.g., the Step Function stack).</li>
</ol>
<h3 id="Automating-with-CodePipeline"><a href="#Automating-with-CodePipeline" class="headerlink" title="Automating with CodePipeline:"></a>Automating with CodePipeline:</h3><p>To automate this process using AWS CodePipeline, you would set up a pipeline that deploys these stacks in the correct order.</p>
<h4 id="Example-CodePipeline-CloudFormation-Template"><a href="#Example-CodePipeline-CloudFormation-Template" class="headerlink" title="Example CodePipeline CloudFormation Template:"></a>Example CodePipeline CloudFormation Template:</h4><p>Here’s a simplified structure of what the CloudFormation template for setting up such a CodePipeline might look like:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">AWSTemplateFormatVersion:</span> <span class="string">&#x27;2010-09-09&#x27;</span></span><br><span class="line"><span class="attr">Resources:</span></span><br><span class="line">  <span class="comment"># Define the CodePipeline and its stages</span></span><br><span class="line">  <span class="attr">MyCodePipeline:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::CodePipeline::Pipeline</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="comment"># ... Pipeline configuration ...</span></span><br><span class="line">      <span class="attr">Stages:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Name:</span> <span class="string">Source</span></span><br><span class="line">          <span class="comment"># ... Source configuration ...</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Name:</span> <span class="string">Build</span></span><br><span class="line">          <span class="comment"># ... Build configuration ...</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Name:</span> <span class="string">DeployLambdaFunctions</span></span><br><span class="line">          <span class="attr">Actions:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">Name:</span> <span class="string">DeployLambda</span></span><br><span class="line">              <span class="attr">ActionTypeId:</span></span><br><span class="line">                <span class="attr">Category:</span> <span class="string">Deploy</span></span><br><span class="line">                <span class="attr">Owner:</span> <span class="string">AWS</span></span><br><span class="line">                <span class="attr">Version:</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                <span class="attr">Provider:</span> <span class="string">CloudFormation</span></span><br><span class="line">              <span class="attr">Configuration:</span></span><br><span class="line">                <span class="attr">ActionMode:</span> <span class="string">CREATE_UPDATE</span></span><br><span class="line">                <span class="attr">TemplatePath:</span> <span class="comment"># ... Path to your Lambda stack template ...</span></span><br><span class="line">                <span class="attr">StackName:</span> <span class="string">&quot;LambdaFunctionStack&quot;</span></span><br><span class="line">                <span class="comment"># ... Other configurations ...</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Name:</span> <span class="string">DeploySNS</span></span><br><span class="line">          <span class="comment"># Similar to above, for SNS stack</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Name:</span> <span class="string">DeployStepFunction</span></span><br><span class="line">          <span class="comment"># Similar to above, for Step Function stack</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ... Other necessary resources like IAM roles, S3 buckets, etc.</span></span><br></pre></td></tr></table></figure>

<p>This pipeline has stages that deploy each stack in order. Each deployment stage will use the AWS CloudFormation provider to deploy a specific stack. You need to ensure that the artifacts from the build stage (i.e., packaged CloudFormation templates) are available for these deployment stages.</p>
<h3 id="Key-Points"><a href="#Key-Points" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li>The order of stages in CodePipeline is crucial. Ensure dependent resources are deployed before the resources that need them.</li>
<li>You can add manual approval steps between stages if needed, especially for production environments.</li>
<li>Ensure that the IAM roles used by CodePipeline have the necessary permissions to create and manage the resources defined in your CloudFormation templates.</li>
</ul>

            </div>

            

            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2024/01/08/StreamIngestion/codepipeline/Set%20Up%20AWS%20CodeCommit%20Repository/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item"></span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2024/01/05/StreamIngestion/codepipeline/CloudFormationTemplateforSNSTopicAndStepFunction/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item"></span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#How-it-Works"><span class="nav-number">1.</span> <span class="nav-text">How it Works:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Exporting-Outputs-in-One-Stack"><span class="nav-number">1.1.</span> <span class="nav-text">1. Exporting Outputs in One Stack:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Importing-Outputs-in-Another-Stack"><span class="nav-number">1.2.</span> <span class="nav-text">2. Importing Outputs in Another Stack:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Deployment-Process-Without-CodePipeline"><span class="nav-number">2.</span> <span class="nav-text">Deployment Process Without CodePipeline:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Automating-with-CodePipeline"><span class="nav-number">3.</span> <span class="nav-text">Automating with CodePipeline:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Example-CodePipeline-CloudFormation-Template"><span class="nav-number">3.1.</span> <span class="nav-text">Example CodePipeline CloudFormation Template:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-Points"><span class="nav-number">4.</span> <span class="nav-text">Key Points:</span></a></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2020</span> -
            
            2024
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">Kai Li</a>
            
        </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>





    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-block.js"></script>





<div class="post-scripts">
    
        
<script src="/js/post-helper.js"></script>

        
            
<script src="/js/libs/anime.min.js"></script>

        
        
            
<script src="/js/toc.js"></script>

        
    
</div>



</body>
</html>
